// @flow

import type { DispatchAPI } from 'redux';
import {
    actionCreator,
    request,
} from '../utils';
import { routerSelectors } from '../selectors';
import {
    TRANSLATION_REQUEST,
    TRANSLATION_SUCCESS,
    TRANSLATION_FAILURE,
    TRANSLATION_CLEAR_STATE,
    TRANSLATION_REMOVE_PRONUNCIATION_REQUEST,
    TRANSLATION_REMOVE_PRONUNCIATION_SUCCESS,
    TRANSLATION_REMOVE_PRONUNCIATION_FAILURE,
    TRANSLATION_IMAGE_REQUEST,
    TRANSLATION_IMAGE_SUCCESS,
    TRANSLATION_IMAGE_FAILURE,
} from '../types/actions/translation';
import type { StoreState } from '../store/type';
import type {
    TranslationResponse,
} from '../types';

export const get = (word: string) => (
    dispatch: DispatchAPI<*>,
    getState: () => StoreState
): Promise<TranslationResponse> => {
    const apiUrl = routerSelectors.getApiUrl(getState());
    return actionCreator({
        dispatch,
        requestAction: TRANSLATION_REQUEST,
        successAction: TRANSLATION_SUCCESS,
        failureAction: TRANSLATION_FAILURE,
        // action: () => request.get({
        //     url: `${apiUrl}/translate?q=${word}`,
        //     headers: {
        //         Authorization: process.env.API_KEY,
        //     },
        // }),
        action: () => Promise.resolve({"word":"head","raw":[[["голова","head",null,null,1],[null,null,"golova","hed"]],[["noun",["голова","глава","головка","руководитель","начальник","заголовок","кочан","крышка","изголовье","верхняя часть","пена","ум","шляпка","нос","бабка","вождь","передняя часть","человек","верхушка","отдел","капитель","набалдашник","мыс","гальюн","перед","обух","крона","боек","котелок","гидростатический напор","кризис","руда","замочный камень","руководящее положение","давление столба жидкости","нужник","черенок","шляпка гвоздя","верхний брус оконной коробки","нос корабля","голова скота","лицевая сторона монеты","кризис болезни","перелом болезни","ведущее положение","верхний брус дверной коробки","исток реки","назревшая головка нарыва","прибыль","сливки","наркоман","способности","рубрика","концентрат","топ"],[["голова",["head","brain","loaf","pate","noggin","bonce"],null,0.115758404,null,2],["глава",["chapter","head","section","chief","leader","principal"],null,0.11219689,null,4],["головка",["head","knob","cap","capitulum","pommel"],null,0.07473924,null,2],["руководитель",["head","leader","manager","director","supervisor","chief"],null,0.0691225,null,1],["начальник",["chief","head","superior","supervisor","director","commander"],null,0.06392786,null,1],["заголовок",["heading","headline","caption","head","banner","topic"],null,0.00024162467,null,1],["кочан",["head","loaf"],null,0.00017403573,null,1],["крышка",["cap","cover","lid","case","hood","head"],null,0.000121496516,null,2],["изголовье",["head","head of the bed","bedhead"],null,0.00011593278,null,3],["верхняя часть",["head","topping"],null,0.00009171038,null,2],["пена",["foam","froth","scum","lather","head","spume"],null,0.000088888744,null,2],["ум",["mind","intelligence","intellect","wit","brain","head"],null,0.000088888744,null,1],["шляпка",["cap","head"],null,0.000088888744,null,2],["нос",["nose","prow","head","snout","naze","neb"],null,0.00007254888,null,1],["бабка",["head","pastern","stock","old wife","chestnut","knucklebone"],null,0.000057390887,null,2],["вождь",["leader","chief","chieftain","head","headman","dux"],null,0.000057390887,null,1],["передняя часть",["nose","head","forepart","forehead"],null,0.0000359143],["человек",["man","person","human","individual","human being","head"],null,0.0000332153,null,1],["верхушка",["top","tip","apex","head","cap","cop"],null,0.00002885795,null,2],["отдел",["department","division","branch","desk","group","head"],null,0.000023553173,null,1],["капитель",["cap","head","small capitals"],null,0.000011659667,null,2],["набалдашник",["knob","head"],null,0.000009973041,null,1],["мыс",["cape","headland","promontory","point","ness","head"],null,0.000009973041,null,1],["гальюн",["latrine","head"],null,0.000009080557,null,1],["перед",["front","head"],null,0.000009080557,null,1],["обух",["butt","head","back"],null,0.000008139759,null,1],["крона",["crown","krone","krona","dollar","head","crownpiece"],null,0.000007183312,null,2],["боек",["peen","head"],null,0.0000063392504,null,1],["котелок",["bowler","pot","kettle","bowler hat","derby","head"],null,0.0000054222483,null,1],["гидростатический напор",["head"],null,0.0000054222483],["кризис",["crisis","slump","brunt","head","acme","turning-point"],null,0.0000044952017,null,1],["руда",["ore","mineral","head","heads"],null,0.0000036119961,null,2],["замочный камень",["head"],null,0.0000036119961],["руководящее положение",["head","headship"],null,0.0000026842076],["давление столба жидкости",["head"],null,0.0000026842076],["нужник",["can","john","head"],null,0.0000018162257,null,1],["черенок",["stalk","cutting","stem","shank","shaft","head"],null,0.0000018162257,null,1],["шляпка гвоздя",["head","nail-head"],null,0.0000018162257],["верхний брус оконной коробки",["head"],null,0.0000018162257,null,1],["нос корабля",["stem","bow","head","rostrum"],null,0.0000018162257],["голова скота",["head"],null,0.0000018162257,null,2],["лицевая сторона монеты",["head"],null,0.0000018162257],["кризис болезни",["head"],null,0.0000018162257],["перелом болезни",["head"],null,0.0000018162257],["ведущее положение",["head"],null,0.0000018162257],["верхний брус дверной коробки",["head"],null,0.0000018162257,null,1],["исток реки",["head","springhead","fountain"],null,0.0000018162257],["назревшая головка нарыва",["head"],null,0.0000018162257],["прибыль",["profit","income","earnings","gain","return","head"],null,0.0000018162257,null,2],["сливки",["cream","plum","head"],null,0.0000018162257],["наркоман",["addict","drug addict","junkie","narcomaniac","freak","head"],null,0.0000018162257,null,1],["способности",["aptitude","part","head"],null,8.990969e-7],["рубрика",["heading","rubric","bracket","head"],null,8.990969e-7,null,2],["концентрат",["concentrate","head"],null,8.990969e-7,null,1],["топ",["head"],null,8.990969e-7,null,1]],"head",1],["adjective",["головной","главный","старший","встречный","передний"],[["головной",["head","cephalic","leading","nose","cranial","advance"],null,0.060054667],["главный",["main","major","chief","principal","primary","head"],null,0.027928013],["старший",["senior","elder","older","head","major","superior"],null,0.0010172778],["встречный",["counter","head","meeting","foul"],null,0.000110623834],["передний",["front","anterior","forward","fore","head","foremost"],null,0.00008350325]],"head",3],["verb",["возглавлять","направляться","держать курс","направлять","вести","брать начало","служить заглавием","отбивать мяч головой","озаглавливать","играть головой","завиваться","формировать"],[["возглавлять",["lead","head","chair","spearhead","forge","forge ahead"],null,0.029729217],["направляться",["head","go","tend","make","strike","go for"],null,0.000022474595],["держать курс",["head","stand","cape"],null,0.0000063392504],["направлять",["guide","head","direct","destine","route","refer"],null,0.0000054222483],["вести",["lead","conduct","keep","guide","drive","head"],null,0.0000044952017],["брать начало",["originate","spring","stem","head"],null,0.0000036119961],["служить заглавием",["head"],null,0.0000018162257],["отбивать мяч головой",["head"],null,0.0000018162257],["озаглавливать",["headline","entitle","head","intitule"],null,0.0000018162257],["играть головой",["head"],null,0.0000018162257],["завиваться",["curl","frizzle","head","head up","crisp","frizzle up"],null,0.0000018162257],["формировать",["form","shape","mold","troop","texture","head"],null,8.990969e-7]],"head",2]],"en",null,null,[["head",null,[["голова",1000,true,false],["глава",1000,true,false]],[[0,4]],"head",0,0]],0.9895833,null,[["en"],null,[0.9895833],["en"]],null,null,[["verb",[[["command","control","lead","run","manage","direct","supervise","superintend","oversee","preside over","rule","govern","captain","be the boss of"],"m_en_us1253938.045"],[["lead","be at the front of","be first","lead the way"],"m_en_us1253938.044"],[["move toward","make for","aim for","go in the direction of","be bound for","make a beeline for","set out for","start out for"],"m_en_us1253938.048"],[["direct","manoeuver","point","channelize","steer","guide","maneuver"],""],[["lead"],""],[["head up"],""]],"head"],["noun",[[["skull","cranium","crown","nut","noodle","noggin","dome"],"m_en_us1253938.001"],[["leader","chief","controller","governor","superintendent","commander","captain","director","manager","principal","president","premier","chieftain","headman","sachem","CEO","boss","boss man","kingpin","top dog","Mr. Big","skipper","ringleader","numero uno","head honcho","big kahuna"],"m_en_us1253938.032"],[["source","origin","headspring","headwater","wellspring"],"m_en_us1253938.024"],[["froth","foam","bubbles","spume","fizz","effervescence","suds"],"m_en_us1253938.030"],[["front","beginning","start","fore","forefront","top"],"m_en_us1253938.017"],[["brain(s)","brainpower","intellect","intelligence","wit(s)","wisdom","mind","sense","reasoning","common sense","savvy","gray matter","smarts"],"m_en_us1253938.002"],[["aptitude","faculty","talent","gift","capacity","ability","mind","brain"],"m_en_us1253938.003"],[["caput"],""],[["headland","promontory","foreland"],""],[["headway"],""],[["drumhead"],""],[["straits","pass"],""],[["brain","psyche","nous","mind"],""],[["fountainhead","headspring"],""],[["chief","top dog"],""],[["question"],""],[["heading","header"],""],[["forefront"],""],[["capitulum"],""],[["point"],""],[["oral sex"],""],[["school principal","principal","head teacher"],""],[["head word"],""]],"head"],["adjective",[[["chief","principal","leading","main","first","foremost","prime","premier","senior","top","highest","supreme","superior","top-ranking","ranking"],"m_en_us1253938.043"]],"head"]],[["verb",[["be in the leading position on.","m_en_us1253938.044","At the festival celebrated in the country around Athens, a jar of wine and a vine headed the procession."],["give a title or caption to.","m_en_us1253938.046","One review, in a leading German paper, was headed : ‘Not to be touched with a barge pole.’"],["move in a specified direction.","m_en_us1253938.048","She also waters each plant thoroughly every Sunday afternoon before she heads home."],["shoot or pass (the ball) with the head.","m_en_us1253938.051","a corner kick that he headed into the net"],["lop off the upper part or branches of (a plant or tree).","m_en_us1253938.052","The trunks of some trees have been headed which causes several branches to grow from just below the cut."],["(of a lettuce or cabbage) form a head.","m_en_us1253938.053","Under very cool conditions, as in an unheated solar greenhouse or a polyethylene tunnel, any Asian heading cabbage will grow more loose and open."]],"head"],["noun",[["the upper part of the human body, or the front or upper part of the body of an animal, typically separated from the rest of the body by a neck, and containing the brain, mouth, and sense organs.","m_en_us1253938.001","All were massively built animals with small heads and barrel-like bodies."],["a thing having the appearance of a head either in form or in relation to a whole, in particular.","m_en_us1253938.010"],["the front, forward, or upper part or end of something, in particular.","m_en_us1253938.017"],["the word that governs all the other words in a phrase in which it is used, having the same grammatical function as the whole phrase.","m_en_us1253938.034","In many grammatical theories, the head of a phrase is defined as that constituent which determines the syntactic category of the phrase."],["a person considered as a numerical unit.","m_en_us1253938.035","If the owner only gets a handful of visits a year it effectively costs the taxpayer thousands of pounds a head ."],["a body of water kept at a particular height in order to provide a supply at sufficient pressure.","m_en_us1253938.039","Measurements in a number of wells are required to map the distribution of hydraulic head within an aquifer."],["a toilet, especially on a boat or ship.","m_en_us1253938.041","The berthing, heads , galley, engine room and other spaces are located below the water line."],["a superficial deposit of rock fragments, formed at the edge of an ice sheet by repeated freezing and thawing and then moved downhill.","m_en_us1253938.042","The rock and soil debris may even move on very shallow slopes, resulting in a large accumulation of head at the valley bottom."]],"head"],["adjective",[["chief; principal.","m_en_us1253938.043","The Knights 2005 squad had their first training session under new head coach Mick Cook last night."]],"head"],["suffix",[["denoting the front, forward, or upper part or end of a specified thing.","m_en_us1253940.001","masthead"],["in nouns used informally to express disparagement of a person.","m_en_us1253940.002","airhead"],["in nouns used informally to denote an addict or habitual user of a specified drug.","m_en_us1253940.003","crackhead"]],"-head"]],[[["put your name at the <b>head</b> of the page",null,null,null,3,"neid_9331"],["He left me at the <b>head</b> of a flight of stairs leading to the basement.",null,null,null,3,"m_en_us1253938.023"],["Typically a two-course meal complete with a couple of drinks will cost only about three pounds fifty per <b>head</b> !",null,null,null,3,"m_en_us1253938.035"],["At the <b>head</b> of the table sat an old man with a shock of white hair that almost matched his robe.",null,null,null,3,"m_en_us1253938.018"],["Took it to the tire shop to have it repaired and the guy said the cause of the severe flatness was a nail: a short nail with a large <b>head</b> .",null,null,null,3,"m_en_us1253938.012"],["As the <i>Grosvenor</i> sliced towards the rocks at six knots, the officer of the watch dismissed reports of shore fires beyond the ship's <b>head</b> .",null,null,null,3,"m_en_us1253938.028"],["Tarrant is currently nearing completion of his term as <b>head</b> coach with the junior women's team.",null,null,null,3,"m_en_us1253938.043"],["The river <b>head</b> is the source not only of the property's water, but also of its joie de vivre.",null,null,null,3,"m_en_us1253938.024"],["If the owner only gets a handful of visits a year it effectively costs the taxpayer thousands of pounds a <b>head</b> .",null,null,null,3,"m_en_us1253938.035"],["To walk to the top of these hills requires a strong heart and a <b>head</b> for heights.",null,null,null,3,"m_en_us1253938.003"],["Many pitched tents more than a fortnight ago to make sure they were at the <b>head</b> of the queue when the homes come on sale tomorrow morning.",null,null,null,3,"m_en_us1253938.020"],["He quickly climbed up the steps and left it coiled in a heap at the <b>head</b> of the stairs.",null,null,null,3,"m_en_us1253938.023"],["The <b>head</b> of the river, the top of the ladder is where all the biggest fish want to be.",null,null,null,3,"m_en_us1253938.024"],["He ushered her to a chair near the <b>head</b> of the table.",null,null,null,3,"m_en_us1253938.018"],["To kill 30000 <b>head</b> of game in a season at Sandringham, even with help, required application of a kind.",null,null,null,3,"m_en_us1253938.036"],["I was put at the <b>head</b> of the table in between Teodora, and Ivan, her Serbian uncle.",null,null,null,3,"m_en_us1253938.018"],["St Petersburg is located on the delta of the Neva River, at the <b>head</b> of the Gulf of Finland.",null,null,null,3,"m_en_us1253938.025"],["the <b>head</b> of a nail",null,null,null,3,"neid_9326"],["He managed to move his 50 <b>head</b> of cattle to safety, but his entire crop of wheat and barley was lost.",null,null,null,3,"m_en_us1253938.036"],["Miss Howitt broke away from a group of her friends when she saw Croft come to the <b>head</b> of the stairs.",null,null,null,3,"m_en_us1253938.023"],["In raw economic statistics about income per <b>head</b> , it has moved towards the UK average.",null,null,null,3,"m_en_us1253938.035"],["I was at the <b>head</b> of the queue",null,null,null,3,"neid_9330"],["My role was to invent some recipes using native plants as herbs, design a menu, and act as <b>head</b> chef on the night.",null,null,null,3,"m_en_us1253938.043"],["we can see his big bald <b>head</b>",null,null,null,3,"neid_9325"],["The seawater stream into which the combustion gas is injected is under pressure via the <b>head</b> of water exerted by the seawater reservoir.",null,null,null,3,"m_en_us1253938.039"],["Six places were set, one at the <b>head</b> of the table, three on the right and two on the left.",null,null,null,3,"m_en_us1253938.018"],["Gwen sat at the <b>head</b> of the table, like a queen and kept her eyes on Jamie at all times.",null,null,null,3,"m_en_us1253938.018"],["I suggested to Barnette that since he was our guest he should sit at the <b>head</b> of the table.",null,null,null,3,"m_en_us1253938.018"],["By 1992 it had the highest quantity of arms per <b>head</b> of population of any country in the world.",null,null,null,3,"m_en_us1253938.035"],["Also qualifying was a veritable list of rowing powers: Italy, Poland, and France <b>head</b> the field.",null,null,null,3,"m_en_us1253938.044"]]]],"pronunciation":"/pronunciations/head.mp3"})
    });
};

export const clearState = () => ({
    type: TRANSLATION_CLEAR_STATE,
});

export const getImage = (word: string) => (
    dispatch: DispatchAPI<*>,
    getState: () => StoreState
): Promise<TranslationResponse> => {
    const apiUrl = routerSelectors.getApiUrl(getState());
    return actionCreator({
        dispatch,
        requestAction: TRANSLATION_IMAGE_REQUEST,
        successAction: TRANSLATION_IMAGE_SUCCESS,
        failureAction: TRANSLATION_IMAGE_FAILURE,
        action: () => request.get({
            url: `${apiUrl}/image?word=${word}`,
            headers: {
                Authorization: process.env.API_KEY,
            },
        }),
    });
};

export const removePronunciation = (word: string) => (
    dispatch: DispatchAPI<*>,
    getState: () => StoreState
): Promise<TranslationResponse> => {
    const apiUrl = routerSelectors.getApiUrl(getState());
    return actionCreator({
        dispatch,
        requestAction: TRANSLATION_REMOVE_PRONUNCIATION_REQUEST,
        successAction: TRANSLATION_REMOVE_PRONUNCIATION_SUCCESS,
        failureAction: TRANSLATION_REMOVE_PRONUNCIATION_FAILURE,
        action: () => request.delete({
            url: `${apiUrl}/pronunciation?word=${word}`,
            headers: {
                Authorization: process.env.API_KEY,
            },
        }),
    });
};
